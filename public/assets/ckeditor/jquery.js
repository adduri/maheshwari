/*
Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
!function(){CKEDITOR.config.jqueryOverrideVal="undefined"==typeof CKEDITOR.config.jqueryOverrideVal?!0:CKEDITOR.config.jqueryOverrideVal;var e=window.jQuery;"undefined"!=typeof e&&(e.extend(e.fn,{ckeditorGet:function(){var e=this.eq(0).data("ckeditorInstance");if(!e)throw"CKEditor not yet initialized, use ckeditor() with callback.";return e},ckeditor:function(t,i){if(!CKEDITOR.env.isCompatible)return this;if(!e.isFunction(t)){var a=i;i=t,t=a}return i=i||{},this.filter("textarea, div, p").each(function(){var a=e(this),n=a.data("ckeditorInstance"),o=a.data("_ckeditorInstanceLock"),r=this;n&&!o?t&&t.apply(n,[this]):o?CKEDITOR.on("instanceReady",function(e){var i=e.editor;setTimeout(function(){return i.element?(i.element.$==r&&t&&t.apply(i,[r]),void 0):(setTimeout(arguments.callee,100),void 0)},0)},null,null,9999):((i.autoUpdateElement||"undefined"==typeof i.autoUpdateElement&&CKEDITOR.config.autoUpdateElement)&&(i.autoUpdateElementJquery=!0),i.autoUpdateElement=!1,a.data("_ckeditorInstanceLock",!0),n=CKEDITOR.replace(r,i),a.data("ckeditorInstance",n),n.on("instanceReady",function(e){var i=e.editor;setTimeout(function(){if(!i.element)return setTimeout(arguments.callee,100),void 0;if(e.removeListener("instanceReady",this.callee),i.on("dataReady",function(){a.trigger("setData.ckeditor",[i])}),i.on("getData",function(e){a.trigger("getData.ckeditor",[i,e.data])},999),i.on("destroy",function(){a.trigger("destroy.ckeditor",[i])}),i.config.autoUpdateElementJquery&&a.is("textarea")&&a.parents("form").length){var n=function(){a.ckeditor(function(){i.updateElement()})};a.parents("form").submit(n),a.parents("form").bind("form-pre-serialize",n),a.bind("destroy.ckeditor",function(){a.parents("form").unbind("submit",n),a.parents("form").unbind("form-pre-serialize",n)})}i.on("destroy",function(){a.data("ckeditorInstance",null)}),a.data("_ckeditorInstanceLock",null),a.trigger("instanceReady.ckeditor",[i]),t&&t.apply(i,[r])},0)},null,null,9999))}),this}}),CKEDITOR.config.jqueryOverrideVal&&(e.fn.val=CKEDITOR.tools.override(e.fn.val,function(t){return function(i,a){var n,o="undefined"!=typeof i;return this.each(function(){var r=e(this),l=r.data("ckeditorInstance");if(!a&&r.is("textarea")&&l){if(!o)return n=l.getData(),null;l.setData(i)}else{if(!o)return n=t.call(r),null;t.call(r,i)}return!0}),o?this:n}})))}();